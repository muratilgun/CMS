!function(){function E(e){return CKEDITOR.env.ie?e.$.clientWidth:parseInt(e.getComputedStyle("width"),10)}function O(e,t){var n=e.getComputedStyle("border-"+t+"-width"),o={thin:"0px",medium:"1px",thick:"2px"};return n.indexOf("px")<0&&(n=n in o&&"none"!=e.getComputedStyle("border-style")?o[n]:0),parseInt(n,10)}function w(e){(e.data||e).preventDefault()}function s(m){function t(){g=0,T.setOpacity(0),v&&function(){for(var r=f.rtl,l=r?b.length:y.length,s=0,e=0;e<l;e++){var t=y[e],n=b[e],u=f.table;CKEDITOR.tools.setTimeout(function(e,t,n,o,i,a){e&&e.setStyle("width",d(Math.max(t+a,1))),n&&n.setStyle("width",d(Math.max(o-a,1))),i&&u.setStyle("width",d(i+a*(r?-1:1))),++s==l&&m.fire("saveSnapshot")},0,this,[t,t&&E(t),n,n&&E(n),(!t||!n)&&E(u)+O(u,"left")+O(u,"right"),v])}}();var e=f.table;setTimeout(function(){e.removeCustomData("_cke_table_pillars")},0),C.removeListener("dragstart",w)}function i(e){w(e),m.fire("saveSnapshot"),e=f.index;for(var t=CKEDITOR.tools.buildTableMap(f.table),n=[],o=[],i=Number.MAX_VALUE,a=i,r=f.rtl,l=0,s=t.length;l<s;l++){var u=(d=t[l])[e+(r?1:0)],d=d[e+(r?0:1)],u=u&&new CKEDITOR.dom.element(u),d=d&&new CKEDITOR.dom.element(d);u&&d&&u.equals(d)||(u&&(i=Math.min(i,E(u))),d&&(a=Math.min(a,E(d))),n.push(u),o.push(d))}y=n,b=o,D=f.x-i,x=f.x+a,T.setOpacity(.5),p=parseInt(T.getStyle("left"),10),v=0,g=1,T.on("mousemove",c),C.on("dragstart",w),C.on("mouseup",h,this)}function h(e){e.removeListener(),t()}function c(e){n(e.data.getPageOffset().x)}var f,g,p,v,n,y,b,D,x,C=m.document,T=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"></div>',C);m.on("destroy",function(){T.remove()}),a||C.getDocumentElement().append(T),this.attachTo=function(e){var t,n,o;g||(a&&(C.getBody().append(T),v=0),t=(f=e).alignedPillars[0],n=f.alignedPillars[f.alignedPillars.length-1],o=t.y,t=n.height+n.y-t.y,T.setStyles({width:d(e.width),height:d(t),left:d(e.x),top:d(o)}),a&&T.setOpacity(.25),T.on("mousedown",i,this),C.getBody().setStyle("cursor","col-resize"),T.show())},n=this.move=function(e,t){if(!f)return 0;if(!(g||e>=f.x&&e<=f.x+f.width&&t>=f.y&&t<=f.y+f.height))return f=null,g=v=0,C.removeListener("mouseup",h),T.removeListener("mousedown",i),T.removeListener("mousemove",c),C.getBody().setStyle("cursor","auto"),a?T.remove():T.hide(),0;var n=e-Math.round(T.$.offsetWidth/2);if(g){if(n==D||n==x)return 1;n=Math.max(n,D),n=Math.min(n,x),v=n-p}return T.setStyle("left",d(n)),1}}function u(e){var t=e.data.getTarget();if("mouseout"==e.name){if(!t.is("table"))return;for(var n=new CKEDITOR.dom.element(e.data.$.relatedTarget||e.data.$.toElement);n&&n.$&&!n.equals(t)&&!n.is("body");)n=n.getParent();if(!n||n.equals(t))return}t.getAscendant("table",1).removeCustomData("_cke_table_pillars"),e.removeListener()}var d=CKEDITOR.tools.cssLength,a=CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks);CKEDITOR.plugins.add("tableresize",{requires:"tabletools",init:function(l){l.on("contentDom",function(){var r,e=l.editable();e.attachListener(e.isInline()?e:l.document,"mousemove",function(e){var h,c,f,g;if((o=(e=e.data).getTarget()).type==CKEDITOR.NODE_ELEMENT){var t=e.getPageOffset().x,n=e.getPageOffset().y;if(r&&r.move(t,n))w(e);else if((o.is("table")||o.getAscendant({thead:1,tbody:1,tfoot:1},1))&&(e=o.getAscendant("table",1),l.editable().contains(e))){(o=e.getCustomData("_cke_table_pillars"))||(e.setCustomData("_cke_table_pillars",(c=[],f={},g="rtl"==(h=e).getComputedStyle("direction"),CKEDITOR.tools.array.forEach(h.$.rows,function(e,t){for(var n=-1,o=0,i=null,o=(i=e?{height:(o=new CKEDITOR.dom.element(e)).$.offsetHeight,position:o.getDocumentPosition()}:void 0).height,i=i.position,a=0,r=e.cells.length;a<r;a++){var l,s,u=new CKEDITOR.dom.element(e.cells[a]),d=e.cells[a+1]&&new CKEDITOR.dom.element(e.cells[a+1]),n=n+(u.$.colSpan||1),m=u.getDocumentPosition().x;g?s=m+O(u,"left"):l=m+u.$.offsetWidth-O(u,"right"),d?(m=d.getDocumentPosition().x,g?l=m+d.$.offsetWidth-O(d,"right"):s=m+O(d,"left")):(m=h.getDocumentPosition().x,g?l=m:s=m+h.$.offsetWidth),u=Math.max(s-l,3),u={table:h,index:n,x:l,y:i.y,width:u,height:o,rtl:g},f[n]=f[n]||[],f[n].push(u),u.alignedPillars=f[n],c.push(u)}}),o=c)),e.on("mouseout",u),e.on("mousedown",u));e:{e=o;for(var o=0,i=e.length;o<i;o++){var a=e[o];if(t>=a.x&&t<=a.x+a.width&&n>=a.y&&n<=a.y+a.height){t=a;break e}}t=null}t&&(r||(r=new s(l)),r.attachTo(t))}}})})}})}();